# SQL漫步

目录：

[toc]

## 课程介绍

本篇教程面向零基础小白，是小编根据华中科技大学数据库视频课程学习的笔记，[视频连接](https://space.bilibili.com/503076092/)。

本教程编写于2021年1月18日。

------

## 绪论

### 数据库系统概述

略

~~（嘿嘿嘿）~~

~~不会有人想学概述吧，不会吧不会吧？~~

### 数据模型

#### 引入

建筑模型

情景：
		·小宇和pljj谈恋爱了，于是找到爸爸让爸爸带小宇去买房子……在售楼大厅看到了这样	的一张图……

猜猜此图出现于什么阶段呢？

猜猜先出现左图还是右图？

如果你猜错了，那你真是跟小编一样聪明！~~（确信）~~

![](.\建筑模型.png)

正解：此图出现于设计阶段，先出现左图，后出现右图

左边是给最终用户看的（小宇和pljj），右边是给专业人士看的（建筑师）。

结论：模型分为多个层次，有的面向终端用户（概念模型），有的面向专业人士（逻辑模型和物理模型）（数据库设计人员·程序猿）。



#### 三要素

数据结构、数据操作、完整性约束条件

数据结构：描述数据对象的静态特征，刻画数据模型的主要特征，常以数据结构的类型命名数据模型。

数据操作：描述动态特征，即对象的实例允许执行的操作及操作规则。~~（面对对象 行）~~。就是增删查改之类的。

完整性约束条件：规定数据库状态及状态变化所应满足的条件，保证数据正确、有效、相容。



#### 概念模型

**按用户的观点来对数据和信息建模**



|  概念  |                     举例                     |
| :----: | :------------------------------------------: |
|  实体  |               学生、老师、校长               |
|  属性  |               学号、成绩、成绩               |
| 实体型 |     学生（学号，姓名，性别，生日，院系）     |
| 实体值 | u2020xxxx、小宇同学、男、2002-0x-xx、计算机  |
| 实体集 |              全体同学、全体老师              |
|   域   |              性别的域（男，女）              |
|   码   | 唯一标识实体的属性集，如学号属性对于学生实体 |
|  联系  |               嗯，就是各种联系               |

~~好家伙，这不是计算思维讲的吗~~

这里的图解（E-R图）请参考计算思维那里讲过的（显然忘干净了）

![](.\ER图.png)

转化后

![](.\1.png)

##### E-R方法范例

在数据库中这里实际应该放4张表，三张表分别存入学生教师和课程的属性，另有一张图反应三个实例间的联系。

![](.\ER2.png)

![](.\ER3.png)

总结：

1. 要忠实于应用需求（实体与属性、联系与类型）
2. 避免冗余
3. 选择合适的元素

#### 逻辑模型

**按计算机实现的观点来对数据建模**

##### 层次模型

特点：有且只有一个结点没有双亲结点（根结点），根结点以外的结点只有一个双亲结点。（数据结构中树的概念）

##### 网状模型

在层次模型的基础上允许1个以上的结点无双亲、一个结点可以有多个双亲。

![](.\网状.png)

##### 关系模型

![](.\关系模型.png)

  

|   概念   |           解释           |
| :------: | :----------------------: |
|   关系   |        对应一张表        |
|   元组   |        表中的一行        |
|   属性   |        表中的一列        |
|   主码   | 能够唯一确定元组的属性组 |
|    域    |      属性的取值范围      |
|   分量   |      元组中的属性值      |
| 关系模式 |         描述关系         |

![](.\关系.png)

-----

### 数据库系统结构

内部结构（开发角度）

​	三级模式：外模式--模式--内模式

外部结构（用户）

​	单用户结构、主从式结构、分布式结构

#### 型与值

![](.\型与值.png)

型是对某一类数据的结构和属性的说明，值是型的具体赋值。型稳定而值变化。

#### 三级模式结构

![](.\3级模式.png)

##### 模式

（逻辑模式）（唯一）（模式结构的中间层）

1. 数据库中全体数据的逻辑结构和特征的描述
2. 所有用户的公共数据视图，综合了所有用户的需求
3. 全体性、逻辑性、特征性(名称/类型/长度/约束)、说明性

##### 外模式

(也称子模式或用户模式)

1. 数据库用户（包括应用程序员和最终用户）使用的局部数据的逻辑结构和特征的描述

2. 数据库用户的数据视图，是与某一应用有关的数据的逻辑表示

3. 外模式通常是模式的子集(可以重叠)

4. 一个数据库可以有多个外模式。反映了不同的用户的应用需求、看待数据的方式、对数据保密的要求

5. 模式中同一数据，在外模式中的结构、类型、长度、保密级别等都可以不同

6. 外模式与应用的关系:一对多

7. 同一外模式也可以为某一用户的多个应用系统所使用，但一个应用程序只能使用一个外模式。

##### 内模式

内模式（也称存储模式、物理模式)

1. 是数据物理结构和存储方式的描述，是数据在数据库内部的表示方式

2. 记录的存储方式（顺序存储，按照B树结构存储，按hash方法存储)

3. 索引的组织方式、数据是否压缩存储、数据是否加密

4. 数据存储记录结构的规定：—个数据库只有一个内模式

#### 二级映像

##### 外模式/模式映象

1. 定义外模式与模式之间的对应关系

2. 每一个外模式都对应一个外模式/模式映象
3. 映象定义通常包含在各自外模式的描述中

用途：保证了数据的逻辑独立性

逻辑独立性：![](.\逻辑独立性.png)

##### 模式/内模式映象

1. 模式/内模式映象定义了数据全局逻辑结构与存储结构之间的对应关系。	例如，说明逻辑记录和字段在内部是如何表示的
2. 数据库中模式/内模式映象是唯一的该映象定义通常包含在模式描述中

用途：保证了数据的物理独立性

#### 客户角度

单用户数据库（自己玩）、主从式结构数据库系统（类似电脑主机和外设的关系）、分布式数据库系统

客户/服务器结构（C/S）

1. 电脑上下载本地的app

2. DBMS功能和应用分开（数据库服务器和应用机的分开）

   ![](.\C_S.png)

浏览器/应用服务器/数据库服务器结构（B/S）

1. 浏览器输入Url就可以使用

### 小结

（~~够简略了，没有更简略的总结略略略~~）

------

## 关系数据库

### 关系数据结构

#### 关系

| 名       | 定义                                    | 例                   |
| -------- | --------------------------------------- | -------------------- |
| 域       | 域是一组具有相同数据类型的值的集合      | {‘男’，‘女’}         |
| 笛卡尔积 | 所有域组合起来的所有可能的集合          | 参考线性代数         |
| 关系     | D1*D2...的子集叫做在域D1 D2 ...上的关系 | 记作R（D1,D2,...,Dn) |

![](.\码.png)

| 名       | 解释                                                       |
| -------- | ---------------------------------------------------------- |
| 基本关系 | 实际存在的表，是实际存储数据的逻辑表示查询表               |
| 查询表   | 查询结果对应的表                                           |
| 视图表   | 由基本表或其他视图表导出的表，是虚表，不对应实际存储的数据 |

**基本性质**

1. 列是同质的
2. 不同列可来自同一个域
3. 列的顺序无所谓

#### 关系模式

R（U,D,dom,F）

关系名（属性的集合，域的集合，属性向域的映像的集合，属性间数据依赖关系的集合）

#### 关系数据库

在一个给定的应用领域中，所有实体及实体之间联系的关系的集合构成一个关系数据库。

1. 其型是关系模式的集合，即数据库描述，称作数据库的内涵(Intension)

2. 其值是某一时刻关系的集合，称作数据库的外延(Extension)

### 关系操作![关系操作](.\关系操作.png)

### 完整性

#### 实体完整性

主属性不能为空（学号不能是空的）

#### 参照完整性

外码不能为空

#### 用户定义完整性

比如要求学号必须是八位数之类的 